# EVE CommissarBo

EVE Commissar — это Discord бот и веб приложение с открытым исходным кодом для управления ролями на сервере Discord на основании нахождения персонажей пользователя в корпорации EVE Online.

[Bot invite link](https://discord.com/api/oauth2/authorize?client_id=1157665492564197437&permissions=268437504&scope=bot)

## Содержание

* [Руководство администратора](#руководство-администратора)
* [Руководство пользователя](#руководство-пользователя)

## Руководство администратора
    
**Предусловия**

* Создайте и настройте на сервере Discord роли, которые EVE Commissar должен выдавать.
* Роль EVECommissar в списке ролей сервера должна быть выше ролей, которые бот должен выдавать \ отзывать.
* На сервере должен быть текстовый канал для уведомлений о выдаче \ отзыве ролей ботом.
* Для создания автоматических правил вам понадобится внутриигровой ID корпорации, который может быть легко получен на zKillboard или Dotlan.

**Создание правил**

После выполнения предусловий можно создать правило с помощью команды `/rules add`.

Команда принимает 4 аргумента:
* corporation_id — ID корпорации в EVE Online;
* role — роль, которая должна назначаться ботом;
* channel — канал для уведомлений;
* locale — название локали (языка) для уведомлений бота.
    
После создания правила EVE Commissar может выполнять автоматизированные задачи по выдаче \ отзыву ролей.

Используй команду `/rules show` для просмотра списка правил.\
Используй команду `/rules remove` для удаления правила.

**Автоматизированные задачи**

* EVE Commissar обновляет информацию о зарегистрированных персонажах каждые 4 часа.
* EVE Commissar проверяет необходимость выдачи роли каждые 5 минут.
  * Для выдачи роли у пользователя должен быть хотя бы один зарегистрированный персонаж в указанной корпорации.
  * Для отзыва роли у пользователя не должно быть зарегистрированного персонажа в указанной корпорации.
      
**Управление пользователями**

Используй команду `/member info` для проверки зарегистрированных пользователем персонажей.

Команда `/member register` может быть использована для самостоятельной регистрации персонажа другого пользователя при условии, что ты знаешь ID персонажа.

**Отчеты**

* `/reports stats` — просмотр статистики регистрации пользователей.
* `/reports unregistered` — вывод списка пользователей, которые еще не зарегистрировали ни одного персонажа.
* `/reports registered` — просмотр статистики зарегистрированных пользователей и персонажей.

**Соображения безопасности**
       
* EVECommissar — приложение с открытым исходным кодом.
* В процессе авторизации персонажей EVECommissar запрашивает авторизационную информацию OAuth 2.0 от `login.eveonline.com`, используя только область применения (scope) 'publicData'.
* EVECommissar не хранит авторизационную информацию (access_token, refresh_token).
* Ключ доступа (access_token) используется только один раз для подтверждения ID персонажа.

Обращайтесь к [sso_authorization_flow](`https://docs.esi.evetech.net/docs/sso/sso_authorization_flow.html`) для получения дополнительной информации об OAuth 2.0

## Руководство пользователя
    
* Начни с выполнения команды `/character register` для регистрации твоего первого персонажа EVE Online с помощью бота.
* Команда `/character info` может быть использована для просмотра списка твоих зарегистрированных персонажей. 
* Команда `/character remove` — для удаления.  